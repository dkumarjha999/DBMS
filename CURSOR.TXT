     DELIMITER #
     DROP PROCEDURE IF EXISTS GRADE;
     CREATE PROCEDURE GRADE(R INT)
     BEGIN
     DECLARE DONE INT DEFAULT 0;
     DECLARE G VARCHAR(5);
     DECLARE NAM VARCHAR(30);
     DECLARE A,B,C,D,E,F,T FLOAT(5,2);
     DECLARE CUR CURSOR FOR SELECT ROLL,NAME,M1,M2,M3,M4,M5,M6 FROM TEST;
     DECLARE CONTINUE HANDLER FOR NOT FOUND SET DONE=1;
     OPEN CUR;
     READLOOP:LOOP
     FETCH CUR INTO R,NAM,A,B,C,D,E,F;
     SET T=A+B+C+D+E+F;
     IF T>480 THEN
     SET G="A";
     ELSE IF T>400 THEN 
     SET G="B+";
     ELSE IF T>360 THEN
     SET G="B";
     ELSE IF T>300 THEN 
     SET G="C";
     ELSE 
     SET G="FAIL";
     END IF;
     END IF;
     END IF;
     END IF;
     IF DONE=1 THEN
     LEAVE READLOOP;
     END IF;
      UPDATE TEST SET GRADE=G,TOTAL=T WHERE TEST.ROLL=R;
     END LOOP;
     CLOSE CUR;
     SELECT ROLL,TOTAL,GRADE FROM TEST WHERE TEST.ROLL=R;
     END #

